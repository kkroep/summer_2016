\documentclass{article}
\usepackage[utf8x]{inputenc}
\usepackage{graphicx}
\usepackage{tikz, amsmath, amssymb, bm, color}
\usepackage{geometry}
\usetikzlibrary{calc}
\usetikzlibrary{shapes,arrows}
\usepackage{todonotes}
\usepackage[american]{circuitikz}
\usepackage{pgfplots}
\usepackage{epstopdf}
\usepackage{listings}
\usepackage{subcaption}
\usepackage{mwe}
\usepackage{float}
\usepackage{cleveref}
\usepackage{ragged2e} % For text alignment


\newenvironment{custom_itemize}{
\begin{itemize}
  \setlength{\itemsep}{0pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
}{\end{itemize}}


%\usepackage{multicol} % Used for the two-column layout of the document


%\usepackage{bm}


\title{Preethi's ROIC analysis}
\author{Kees Kroep 4246373}


\begin{document}
%  \twocolumn[{%
% \begin{@twocolumnfalse}
  \maketitle
%   \end{@twocolumnfalse}
% }]

\section{setup}\label{sec:setup}
\input{tkz/breadboard_tkz}
\input{tkz/schematic_ROIC_tkz}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.6\linewidth]{fig/P1010158.JPG}
	\caption{setup overview}
	\label{fig:setup_overview}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.6\linewidth]{fig/P1010159.JPG}
	\caption{close-up}
	\label{fig:close-up}
\end{figure}

\clearpage

\section{Reset mode}
This test addresses the behavior of the circuit in reset mode. \Cref{tkz:schematic_ROIC_reset} shows the measured values during reset mode. Note that the input voltage is $2.4\,V$, which is important when calculating the input current. 

\input{tkz/ROIC_reset-on_tkz}


\section{Integrator}
This section aims to address the performance of the integrator. \Cref{tkz:integrator_test} shows the setup used for this test. Channel 8 was used, so the end of the $20\,M\Omega$ resistor is connected to IN[8], and the probe is connected to OUT[8]. 

\input{tkz/ROIC_normal_tkz}

One can calculate the expected performance of the integrator using \cref{eq:t_vs_I}. The expected time to discharge the capacitance versus the measured time is plotted in \cref{fig:e_vs_m}. The slope of the $450\,fF$ and $350\,fF$ appear to be reasonably similar to the expected slope, but the $150\,fF$ and especially $50\,fF$ ones are way off. During some testing I found that adding approximately $90\,fF$ to both of those would make the measured and expected values match. It is also interesting to see the current limiting properties of the device in action. All four configurations limit at a $\delta V/\delta t=1.2\cdot10^6$, and with a resistanceof $20\,M\Omega$, this gives a current limitation of $50\,mA$.

\begin{align}
	\delta q&=C\cdot \delta V\\
	I&=\frac{V_{in}-V_0}{R}\\
	\delta t&=\frac{\delta q}{I}\\
	\frac{\delta V}{\delta t}&=\frac{I}{C}=\frac{V_{in}-V_0}{RC}\label{eq:t_vs_I}
\end{align}


\begin{figure}
	\centering
	\begin{subfigure}[b]{0.475\textwidth}
	    \centering
	    \includegraphics[width=\textwidth]{fig/slope_450fF.eps}
	    \caption[Network2]%
	    {$C=450\,fF$}    
	    \label{fig:slopes_450fF}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.475\textwidth}  
	    \centering 
	    \includegraphics[width=\textwidth]{fig/slope_350fF.eps}
	    \caption[]%
	    {$C=350\,fF$}    
	    \label{fig:slopes_350fF}
	\end{subfigure}
	\vskip\baselineskip
	\begin{subfigure}[b]{0.475\textwidth}   
	    \centering 
	    \includegraphics[width=\textwidth]{fig/slope_150fF.eps}
	    \caption[]%
	    {$C=150\,fF$}    
	    \label{fig:slopes_150fF}
	\end{subfigure}
	\quad
	\begin{subfigure}[b]{0.475\textwidth}   
	    \centering 
	    \includegraphics[width=\textwidth]{fig/slope_50fF.eps}
	    \caption[]%
	    {$C=50\,fF$}    
	    \label{fig:slopes_50fF}
	\end{subfigure}
	\caption{Expected versus measured charge up times for different input voltages. The input voltage is connected to the input through a resistor of $20\,M\Omega$}
	\label{fig:slopes}
\end{figure}

\begin{figure}
	\centering
	\begin{subfigure}[b]{0.475\textwidth}
	    \centering
	    \includegraphics[width=\textwidth]{fig/vin_vs_time_sat_450fF.eps}
	    \caption[Network2]%
	    {$C=450\,fF$}    
	    \label{fig:e_vs_m_450fF}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.475\textwidth}  
	    \centering 
	    \includegraphics[width=\textwidth]{fig/vin_vs_time_sat_350fF.eps}
	    \caption[]%
	    {$C=350\,fF$}    
	    \label{fig:e_vs_m_350fF}
	\end{subfigure}
	\vskip\baselineskip
	\begin{subfigure}[b]{0.475\textwidth}   
	    \centering 
	    \includegraphics[width=\textwidth]{fig/vin_vs_time_sat_150fF.eps}
	    \caption[]%
	    {$C=150\,fF$}    
	    \label{fig:e_vs_m_150fF}
	\end{subfigure}
	\quad
	\begin{subfigure}[b]{0.475\textwidth}   
	    \centering 
	    \includegraphics[width=\textwidth]{fig/vin_vs_time_sat_50fF.eps}
	    \caption[]%
	    {$C=50\,fF$}    
	    \label{fig:e_vs_m_50fF}
	\end{subfigure}
	\caption{Expected versus measured charge up times for different input voltages. The input voltage is connected to the input through a resistor of $20\,M\Omega$.}
	\label{fig:e_vs_m}
\end{figure}

\end{document}












